(()=>{"use strict";const t={goodsList:{props:["goods"],template:'\n    <div>\n      <div class="goods-list" v-if=goods.length>\n        <goods-item v-for="good in goods" :good="good"></goods-item>\n      </div>\n      <div class="empty-goods-list" v-else>Ничего не найдено</div>\n    </div>\n  '},goodsItem:{props:["good"],data(){return{addToCart:this.$root.addToCart}},template:'\n    <div class="goods-item">\n      <h3 class="goods-item__name">{{ good.product_name }}</h3>\n      <p class="goods-item__price">{{ good.price }}</p>\n      <button class="btn goods-item__button" type="button" @click=addToCart(good)>Купить</button>\n    </div>\n  '}},o={props:["goods","total","visible","remove"],template:'\n    <div class="сart" v-if=visible>\n      <p class="сart-list__total">{{ total }}</p>\n      <div class="сart-list" v-if=goods.length>\n        <cart-item v-for="(item,index) in goods" :item="item" :index="index" :remove="remove"></cart-item>\n      </div>\n    </div>\n  '},e={props:["item","index","remove"],template:'\n    <div class="сart-item">\n      <h3>{{ item.product_name }}</h3>\n      <p>{{ item.price }}</p>\n      <button class="btn basket-item__button" type="button" @click=remove(item)>Удалить</button>\n    </div>\n  '};Vue.component("goods-search",{props:["search","filter"],template:'\n      <form action="#" class="search">\n        <input type="text" class="goods-search" v-model="search"/>\n        <button class="search-button" type="button" @click="filter(search)"></button>\n      </form>\n    '}),Vue.component("goods-list",t.goodsList),Vue.component("goods-item",t.goodsItem),Vue.component("cart-list",o),Vue.component("cart-item",e),new Vue({el:"#app",data:{goods:[],filteredGoods:[],cartGoods:[],searchLine:"",isVisibleCart:!1},methods:{async getData(t){let o=await fetch(t);return await o.json()},async sendData(t,o){let e={method:"post",headers:{"content-type":"application/json"},body:JSON.stringify(o)},s=await fetch(t,e);return await s.json()},filterGoods(t){const o=new RegExp(t,"i");this.filteredGoods=this.goods.filter((t=>o.test(t.product_name)))},addToCart(t){this.sendData("/addToCart",t).then((t=>{this.cartGoods=t}))},removeFromCart(t){this.sendData("/removeFromCart",t).then((t=>{this.cartGoods=t}))}},computed:{cartTotalPrice(){let t=this.cartGoods.length,o=this.cartGoods.reduce(((t,o)=>t+o.price),0);return this.cartGoods.length?`В корзине ${t} товаров на сумму ${o} рублей`:"Корзина пуста"}},mounted(){this.getData("/catalogData").then((t=>{this.goods=t,this.filteredGoods=t})),this.getData("/cartData").then((t=>{this.cartGoods=t}))}})})();